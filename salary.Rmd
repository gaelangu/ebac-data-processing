---
title: "Data Processing Assignment"
author: "Gaelan Gu, Sunil Prakash, Wang Ruoshi, Yu Yue"
output: 
  md_document:
    variant: markdown_github
---
### Introduction
We will be preparing the salary dataset, extracted from the 1994 US Census, for a logistic regression. 

We will determine whether a person makes over 50k a year; class column will be the dependent variable.

### Data Import
```{r}
train = read.csv('salary-train.csv')
test = read.csv('salary-test.csv')
summary(train)
summary(test)
```

### Setting Entries with Question Marks as NA Values
```{r}
# train set
train$workclass = as.factor(gsub('?', NA, train$workclass, fixed = T))
train$native.country = as.factor(gsub('?', NA, train$native.country, fixed = T))
train$occupation = as.factor(gsub('?', NA, train$occupation, fixed = T))

# test set
test$workclass = as.factor(gsub('?', NA, test$workclass, fixed = T))
test$native.country = as.factor(gsub('?', NA, test$native.country, fixed = T))
test$occupation = as.factor(gsub('?', NA, test$occupation, fixed = T))
```

### Removing Incomplete Cases
```{r}
train = train[complete.cases(train), ]
test = test[complete.cases(test), ]
str(train)
str(test)
```

### Logistic Classifier
```{r}
fit = suppressWarnings(glm(formula = class ~ .,
          family = binomial,
          data = train))
```

### Prediction and Confusion Matrix
```{r}
# Predicting the Test set results
prob_pred = predict(fit, type = 'response', newdata = test[-14])
y_pred = ifelse(prob_pred > 0.5, 1, 0)

### Confusion Matrix
cm = table(test[, 14], y_pred)
cm
```
Model has a 84.8% accuracy rate.
